OBJDIRS += pkg/uclibc/libc/stdio

STDIO_MSRC := pkg/uclibc/libc/stdio/vfprintf.c
STDIO_MOBJ := \
	vfprintf.o _ppfs_init.o _ppfs_prepargs.o _ppfs_setargs.o _ppfs_parsespec.o \
	register_printf_function.o parse_printf_format.o
STDIO_MOBJ := $(patsubst %.o, $(OBJDIR)/pkg/uclibc/libc/stdio/%.o, $(STDIO_MOBJ))

STDIO_MSRC2 := pkg/uclibc/libc/stdio/scanf.c
STDIO_MOBJ2 := \
	vfscanf.o __scan_cookie.o __psfs_parse_spec.o __psfs_do_numeric.o \
        scanf.o sscanf.o fscanf.o vscanf.o vsscanf.o
STDIO_MOBJ2 := $(patsubst %.o, $(OBJDIR)/pkg/uclibc/libc/stdio/%.o, $(STDIO_MOBJ2))

STDIO_CSRC := \
	fclose.c fcloseall.c fdopen.c fgetpos.c fopen.c freopen.c \
        fseeko.c fsetpos.c ftello.c getdelim.c getline.c gets.c getw.c \
        perror.c puts.c putw.c remove.c rewind.c setbuf.c setbuffer.c \
        setlinebuf.c setvbuf.c ungetc.c \
        printf.c vprintf.c vsprintf.c fprintf.c snprintf.c dprintf.c \
        asprintf.c sprintf.c vasprintf.c vdprintf.c vsnprintf.c \
        tmpfile.c tmpnam.c tmpnam_r.c popen.c tempnam.c ctermid.c \
	_READ.c _WRITE.c _adjust_pos.c _fopen.c _fwrite.c \
        _rfill.c _stdio.c _trans2r.c _trans2w.c _wcommit.c \
        _cs_funcs.c _load_inttype.c _store_inttype.c _uintmaxtostr.c \
	__fbufsize.c __flbf.c __fpending.c __fpurge.c __freadable.c \
        __freading.c __fsetlocking.c __fwritable.c __fwriting.c _flushlbf.c

STDIO_CUSRC := \
	clearerr.c feof.c ferror.c fflush.c fgetc.c fgets.c fileno.c \
        fputc.c fputs.c fread.c fwrite.c getchar.c putchar.c

STDIO_C64SRC := \
	fgetpos.c fopen.c freopen.c fseeko.c fsetpos.c ftello.c

LIBC_SRCFILES += $(patsubst %.c, pkg/uclibc/libc/stdio/%.c, $(STDIO_CSRC))
LIBC_SRCFILES += $(patsubst %.c, pkg/uclibc/libc/stdio/%_unlocked.c, $(STDIO_CUSRC))
LIBC_SRCFILES += $(patsubst %.c, pkg/uclibc/libc/stdio/%_64.c, $(STDIO_C64SRC))
LIBC_OBJFILES += $(STDIO_MOBJ) $(STDIO_MOBJ2)

$(STDIO_MOBJ): $(STDIO_MSRC)
	@mkdir -p $(@D)
	$(CC) $(UCLIBC_CFLAGS) -DL_$(patsubst $(OBJDIR)/pkg/uclibc/libc/stdio/%.o,%,$@) $< -c -o $@

$(STDIO_MOBJ2): $(STDIO_MSRC2)
	@mkdir -p $(@D)
	$(CC) $(UCLIBC_CFLAGS) -DL_$(patsubst $(OBJDIR)/pkg/uclibc/libc/stdio/%.o,%,$@) $< -c -o $@

